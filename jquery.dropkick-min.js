/*
 * DropKick 1.5-dev
 *
 * Highly customizable <select> lists
 * https://github.com/robdel12/DropKick
 *
 * Created by: Jamie Lottering <http://github.com/JamieLottering> <http://twitter.com/JamieLottering>
 *
 *
*/(function(e,t,n){"use strict";var i=navigator.userAgent.match(/MSIE ([0-9]{1,}[\.0-9]{0,})/),a=!!i,o=a&&parseFloat(i[1])<7,r=navigator.userAgent.match(/iPad|iPhone|Android|IEMobile|BlackBerry/i),d={},l=[],s={left:37,up:38,right:39,down:40,enter:13,tab:9,zero:48,z:90,last:221},c=['<div class="dk_container" id="dk_container_{{ id }}" tabindex="{{ tabindex }}" aria-hidden="true">','<a class="dk_toggle dk_label">{{ label }}</a>','<div class="dk_options">','<ul class="dk_options_inner" role="main" aria-hidden="true">',"</ul>","</div>","</div>"].join(""),p='<li class="{{ current }}{{ disabled }}"><a data-dk-dropdown-value="{{ value }}">{{ text }}</a></li>',u={startSpeed:400,theme:!1,changes:!1,syncReverse:!0,nativeMobile:!0,autoWidth:!0},k=null,f=null,h=function(e,t,n){var i=e.attr("data-dk-dropdown-value"),a=e.text(),o=t.data("dropkick"),r=o.$select;n=n||!1,t.find(".dk_label").text(a),n?r.val(i):r.val(i).trigger("change"),!o.settings.change||n||o.settings.syncReverse||o.settings.change.call(r,i,a)},v=function(e){e.removeClass("dk_open dk_open_top"),k=null},g=function(n){if(n.data("dropkick").settings.fixedMove)return"up"==n.data("dropkick").settings.fixedMove?!1:!0;var i=n.find(".dk_toggle"),a=n.find(".dk_options").outerHeight(),o=e(t).height()-i.outerHeight()-i.offset().top+e(t).scrollTop(),r=i.offset().top-e(t).scrollTop();return r>a?o>a:!0},_=function(e,t,n){var i=e.find(".dk_options_inner"),a=t.prevAll("li").outerHeight()*t.prevAll("li").length,o=i.scrollTop(),r=i.height()+i.scrollTop()-t.outerHeight();(n&&"keydown"===n.type||o>a||a>r)&&i.scrollTop(a)},b=function(e,t){var n=g(e),i=n?"dk_open":"dk_open_top dk_open";e.find(".dk_options").css({top:n?e.find(".dk_toggle").outerHeight()-1:"",bottom:n?"":e.find(".dk_toggle").outerHeight()-1}),k=e.addClass(i),_(e,e.find(".dk_option_current"),t)},m=function(e,t,n){t.find(".dk_option_current").removeClass("dk_option_current"),e.addClass("dk_option_current"),_(t,e,n)},w=function(t,n){var i,a,o,r,d,l,c,p=t.keyCode,u=n.data("dropkick"),k=String.fromCharCode(p),f=n.find(".dk_options"),g=n.hasClass("dk_open"),_=f.find("li:not(.disabled)"),w=n.find(".dk_option_current"),x=_.first(),C=_.last();switch(p){case s.enter:g?w.hasClass("disabled")||(h(w.find("a"),n),v(n)):b(n,t),t.preventDefault();break;case s.tab:g&&(w.length&&h(w.find("a"),n),v(n));break;case s.up:a=w.prevAll("li:not(.disabled)").first(),g?a.length?m(a,n,t):m(C,n,t):b(n,t),t.preventDefault();break;case s.down:g?(i=w.nextAll("li:not(.disabled)").first(),i.length?m(i,n,t):m(x,n,t)):b(n,t),t.preventDefault()}if(p>=s.zero&&p<=s.z){for(o=(new Date).getTime(),null===u.finder||void 0===u.finder?(u.finder=k.toUpperCase(),u.timer=o):o>parseInt(u.timer,10)+1e3?(u.finder=k.toUpperCase(),u.timer=o):(u.finder=u.finder+k.toUpperCase(),u.timer=o),r=_.find("a"),d=0,l=r.length;l>d;d++)if(c=e(r[d]),0===c.html().toUpperCase().indexOf(u.finder)){h(c,n),m(c.parent(),n,t);break}n.data("dropkick",u)}},x=function(t){return e.trim(t).length>0?t:!1},C=function(t,n){var i,a,o,r,d,l=t.replace("{{ id }}",n.id).replace("{{ label }}",n.label).replace("{{ tabindex }}",n.tabindex),s=[];if(n.options&&n.options.length)for(a=0,o=n.options.length;o>a;a++)r=e(n.options[a]),d=0===a&&void 0!==r.attr("selected")&&void 0!==r.attr("disabled")?null:p.replace("{{ value }}",r.val()).replace("{{ current }}",x(r.val())===n.value?"dk_option_current":"").replace("{{ disabled }}",void 0!==r.attr("disabled")?"disabled":"").replace("{{ text }}",e.trim(r.html())),s[s.length]=d;return i=e(l),i.find(".dk_options_inner").html(s.join("")),i};o||(n.documentElement.className=n.documentElement.className+" dk_fouc"),d.init=function(t){return t=e.extend({},u,t),c=t.dropdownTemplate?t.dropdownTemplate:c,p=t.optionTemplate?t.optionTemplate:p,this.each(function(){var n,i,a=e(this),o=a.find(":selected").first(),d=a.find("option"),s=a.data("dropkick")||{},p=a.attr("id")||a.attr("name"),u=t.width||a.outerWidth(),k=a.attr("tabindex")||"0",h=!!a.attr("disabled"),v=!1;return s.id?a:(s.settings=t,s.tabindex=k,s.id=p,s.$original=o,s.$select=a,s.value=x(a.val())||x(o.attr("value")),s.label=o.text(),s.options=d,v=C(c,s),s.settings.autoWidth&&v.find(".dk_toggle").css({width:u+"px"}),h&&v.attr({disabled:"disabled",tabindex:-1}),a.before(v).appendTo(v),v.fadeIn(t.startSpeed),n=t.theme||"default",v.addClass("dk_theme_"+n),s.theme=n,s.$dk=v,a.data("dropkick",s),v.addClass(a.attr("class")),v.data("dropkick",s),l[l.length]=a,v.on("focus.dropkick",function(){f=v.attr("disabled")?null:v.addClass("dk_focus")}).on("blur.dropkick",function(){v.removeClass("dk_focus"),f=null}),r&&s.settings.nativeMobile&&v.addClass("dk_mobile"),s.settings.syncReverse&&a.on("change",function(t){var n=a.val(),i=e('a[data-dk-dropdown-value="'+n+'"]',v),o=i.text();v.find(".dk_label").text(o),m(i.parent(),v,t),s.settings.change&&s.settings.change.call(a,n,o)}),i=a.attr("form")?e("#"+a.attr("form").replace(" ",", #")):a.closest("form"),void(i.length&&i.on("reset",function(){a.dropkick("reset")})))})},d.theme=function(t){var n=e(this).data("dropkick"),i=n.$dk,a="dk_theme_"+n.theme;i.removeClass(a).addClass("dk_theme_"+t),n.theme=t},d.reset=function(t){return this.each(function(){var n=e(this).data("dropkick"),i=n.$dk,a=e('a[data-dk-dropdown-value="'+n.$original.attr("value")+'"]',i);n.$original.prop("selected",!0),m(a.parent(),i),h(a,i,!t)})},d.setValue=function(t){return this.each(function(){var n=e(this).data("dropkick").$dk,i=e('.dk_options a[data-dk-dropdown-value="'+t+'"]',n);i.length?h(i,n)|m(i.parent(),n):console.warn("There is no option with this value in "+n.selector)})},d.refresh=function(t){return this.each(function(){var n,i,a=e(this).data("dropkick"),o=a.$select,r=a.$dk;a.options=o.find("option"),i=C(c,a).find(".dk_options_inner"),r.find(".dk_options_inner").replaceWith(i),a.$original.parent().length||(a.$original=o.find(":selected").first(),a.label=a.$original.text()),n=e('a[data-dk-dropdown-value="'+o.val()+'"]',r),m(n.parent(),r),h(n,r,!t)})},d.destroy=function(){return this.each(function(){var t=e(this).data("dropkick");t.$dk.before(function(){return t.$select.removeData("dropkick")}).remove()})},d.clone=function(t,n,i){var a=[];e.each(this,function(o){var r=e(this).data("dropkick"),d=r.settings,l=r.$select.clone();d.autoWidth&&(d.width=r.$dk.find(".dk_label").width()),n&&l.attr({id:n}),i&&l.attr({name:i}),l.removeData("dropkick"),0==t?a[o]=l[0]:(l.dropkick(d),a[o]=l.data("dropkick").$dk[0])})},d.disable=function(t){return this.each(function(){var n=e(this).data("dropkick"),i=n.$select,a=n.$dk;0==t?(i.removeAttr("disabled"),a.removeAttr("disabled").attr({tabindex:n.tabindex})):(i.attr({disabled:"disabled"}),a.attr({disabled:"disabled",tabindex:-1}))})},e.fn.dropkick=function(e){if(!o){if(d[e])return d[e].apply(this,Array.prototype.slice.call(arguments,1));if("object"==typeof e||!e)return d.init.apply(this,arguments)}},e(function(){e(n).on(a?"mousedown":"click",".dk_options a",function(){var t=e(this),n=t.parent(),i=t.parents(".dk_container").first();return n.hasClass("disabled")||(n.hasClass("dk_option_current")||(h(t,i),m(t.parent(),i)),v(i)),!1}),e(n).on("keydown.dk_nav",function(e){var t;k?t=k:f&&(t=f),t&&w(e,t)}),e(n).on("click",null,function(t){var n,i=e(t.target);if(k&&0===i.closest(".dk_container").length)v(k);else{if(i.is(".dk_toggle, .dk_label"))return n=i.parents(".dk_container").first(),n.hasClass("dk_open")?v(n):(k&&v(k),!n.attr("disabled")&&b(n,t)),!1;i.attr("for")&&e("#dk_container_"+i.attr("for"))[0]&&e("#dk_container_"+i.attr("for")).trigger("focus.dropkick")}});var i="onwheel"in t?"wheel":"onmousewheel"in n?"mousewheel":"MouseScrollEvent"in t?"DOMMouseScroll MozMousePixelScroll":!1;i&&e(n).on(i,".dk_options_inner",function(e){var t=e.originalEvent.wheelDelta||-e.originalEvent.deltaY||-e.originalEvent.detail;return a?(this.scrollTop-=Math.round(t/10),!1):t>0&&this.scrollTop<=0||0>t&&this.scrollTop>=this.scrollHeight-this.offsetHeight?!1:!0})})})(jQuery,window,document);