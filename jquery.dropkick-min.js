/*
 * DropKick 1.5
 *
 * Highly customizable <select> lists
 * https://github.com/robdel12/DropKick
 *
 * Created by: Jamie Lottering <http://github.com/JamieLottering> <http://twitter.com/JamieLottering>
 *
 *
*/(function(e,t,n){"use strict";var r=navigator.userAgent.match(/MSIE ([0-9]{1,}[\.0-9]{0,})/),i=!!r,s=i&&parseFloat(r[1])<7,o=navigator.userAgent.match(/iPad|iPhone|Android|IEMobile|BlackBerry/i),u={},a=[],f={left:37,up:38,right:39,down:40,enter:13,tab:9,zero:48,z:90,last:221},l=['<div class="dk_container" id="dk_container_{{ id }}" tabindex="{{ tabindex }}" aria-hidden="true">','<a class="dk_toggle dk_label">{{ label }}</a>','<div class="dk_options">','<ul class="dk_options_inner" role="main" aria-hidden="true">',"</ul>","</div>","</div>"].join(""),c='<li class="{{ current }}{{ disabled }}"><a data-dk-dropdown-value="{{ value }}">{{ text }}</a></li>',h='<li class="dk_optgroup{{ disabled }}"><span>{{ text }}</span>',p={startSpeed:400,theme:!1,changes:!1,syncReverse:!0,nativeMobile:!0,autoWidth:!0},d=null,v=null,m=function(e,t,n){var r=e.attr("data-dk-dropdown-value"),i=e.text(),s=t.data("dropkick"),o=s.$select;n=n||!1;t.find(".dk_label").text(i?i:"&nbsp;");n?o.val(r):o.val(r).trigger("change");s.settings.change&&!n&&!s.settings.syncReverse&&s.settings.change.call(o,r,i)},g=function(e){e.removeClass("dk_open dk_open_top");d=null},y=function(n){if(n.data("dropkick").settings.fixedMove)return n.data("dropkick").settings.fixedMove=="up"?!1:!0;var r=n.find(".dk_toggle"),i=n.find(".dk_options").outerHeight(),s=e(t).height()-r.outerHeight()-r.offset().top+e(t).scrollTop(),o=r.offset().top-e(t).scrollTop();return i<o?i<s:!0},b=function(e,t,n){var r=e.find(".dk_options_inner"),i=t.prevAll("li").outerHeight()*t.prevAll("li").length,s=r.scrollTop(),o=r.height()+r.scrollTop()-t.outerHeight();t.closest(".dk_optgroup",r).length&&(i+=t.closest(".dk_optgroup",r).prevAll("li").outerHeight()*t.closest(".dk_optgroup",r).prevAll("li").length);(n&&n.type==="keydown"||i<s||i>o)&&r.scrollTop(i)},w=function(e,t){var n=y(e),r=n?"dk_open":"dk_open_top dk_open";e.find(".dk_options").css({top:n?e.find(".dk_toggle").outerHeight()-1:"",bottom:n?"":e.find(".dk_toggle").outerHeight()-1});d=e.addClass(r);b(e,e.find(".dk_option_current"),t)},E=function(e,t,n){t.find(".dk_option_current").removeClass("dk_option_current");e.addClass("dk_option_current");b(t,e,n)},S=function(t,n){var r=t.keyCode,i=n.data("dropkick"),s=String.fromCharCode(r),o=n.find(".dk_options"),u=n.hasClass("dk_open"),a=o.find("li:not(.disabled)"),l=n.find(".dk_option_current"),c=a.first().hasClass("dk_optgroup")?a.first().find("li:not(.disabled)").first():a.first(),h=a.last().hasClass("dk_optgroup")?a.last().find("li:not(.disabled)").last():a.last(),p,d,v,y,b,S,x;switch(r){case f.enter:if(u){if(!l.hasClass("disabled")){m(l.find("a"),n);g(n)}}else w(n,t);t.preventDefault();break;case f.tab:if(u){l.length&&m(l.find("a"),n);g(n)}break;case f.up:if(u){d=l.prevAll("li:not(.disabled)").first();d.hasClass("dk_optgroup")&&(d=d.find("li:not(.disabled)").last());!d.length&&l.closest(".dk_optgroup").length&&(d=l.closest(".dk_optgroup").prevAll("li:not(.disabled)").first().hasClass("dk_optgroup")?l.closest(".dk_optgroup").prevAll("li:not(.disabled)").first().find("li:not(.disabled)").last():l.closest(".dk_optgroup").prevAll("li:not(.disabled)").first());d.length?E(d,n,t):E(h,n,t)}else w(n,t);t.preventDefault();break;case f.down:if(u){p=l.nextAll("li:not(.disabled)").first();p.hasClass("dk_optgroup")&&(p=p.find("li:not(.disabled)").first());!p.length&&l.closest(".dk_optgroup").length&&(p=l.closest(".dk_optgroup").nextAll("li:not(.disabled)").first().hasClass("dk_optgroup")?l.closest(".dk_optgroup").nextAll("li:not(.disabled)").first().find("li:not(.disabled)").first():l.closest(".dk_optgroup").nextAll("li:not(.disabled)").first());p.length?E(p,n,t):E(c,n,t)}else w(n,t);t.preventDefault();break;default:}if(r>=f.zero&&r<=f.z){v=(new Date).getTime();if(i.finder===null||i.finder===undefined){i.finder=s.toUpperCase();i.timer=v}else if(v>parseInt(i.timer,10)+1e3){i.finder=s.toUpperCase();i.timer=v}else{i.finder=i.finder+s.toUpperCase();i.timer=v}y=a.find("a");for(b=0,S=y.length;b<S;b++){x=e(y[b]);if(x.html().toUpperCase().indexOf(i.finder)===0&&!x.closest(".dk_optgroup",o).hasClass("disabled")){m(x,n);E(x.parent(),n,t);break}}n.data("dropkick",i)}},x=function(t){return e.trim(t).length>0?t:!1},T=function(t,n){var r=function(t){return c.replace("{{ value }}",t.val()).replace("{{ current }}",x(t.val())===n.value?"dk_option_current":"").replace("{{ disabled }}",t.attr("disabled")!==undefined?"disabled":"").replace("{{ text }}",e.trim(t.html())?e.trim(t.html()):"&nbsp;")},i=t.replace("{{ id }}",n.id).replace("{{ label }}",n.label).replace("{{ tabindex }}",n.tabindex),s=[],o,u,a,f,l;if(n.options&&n.options.length)for(u=0,a=n.options.length;u<a;u++){f=e(n.options[u]);if(f.is("option"))l=u===0&&f.attr("selected")!==undefined&&f.attr("disabled")!==undefined?null:r(f);else if(f.is("optgroup")){l=h.replace("{{ text }}",f.attr("label")||"---").replace("{{ disabled }}",f.attr("disabled")!==undefined?" disabled":"");if(e(n.options[u]).children().length){l+="<ul>";for(var p=0,d=e(n.options[u]).children().length;p<d;p++){var v=e(n.options[u]).children().eq(p);l+=r(v)}l+="</ul>"}l+="</li>"}s[s.length]=l}o=e(i);o.find(".dk_options_inner").html(s.join(""));return o};s||(n.documentElement.className=n.documentElement.className+" dk_fouc");u.init=function(t){t=e.extend({},p,t);l=t.dropdownTemplate?t.dropdownTemplate:l;c=t.optionTemplate?t.optionTemplate:c;return this.each(function(){var n=e(this),r=n.find(":selected").first(),i=n.children(),s=n.data("dropkick")||{},u=n.attr("id")||n.attr("name"),f=t.width||n.outerWidth(),c=n.attr("tabindex")||"0",h=!!n.attr("disabled"),p=!1,d,m;if(s.id)return n;s.settings=t;s.tabindex=c;s.id=u;s.$original=r;s.$select=n;s.value=x(n.val())||x(r.attr("value"));s.label=r.text()?r.text():"&nbsp;";s.options=i;p=T(l,s);s.settings.autoWidth&&p.find(".dk_toggle").css({width:f+"px"});h&&p.attr({disabled:"disabled",tabindex:-1});n.before(p).appendTo(p);p.fadeIn(t.startSpeed);d=t.theme||"default";p.addClass("dk_theme_"+d);s.theme=d;s.$dk=p;n.data("dropkick",s);p.addClass(n.attr("class"));p.data("dropkick",s);a[a.length]=n;p.on("focus.dropkick",function(){v=p.attr("disabled")?null:p.addClass("dk_focus")}).on("blur.dropkick",function(){p.removeClass("dk_focus");v=null});o&&s.settings.nativeMobile&&p.addClass("dk_mobile");s.settings.syncReverse&&n.on("change",function(t){var r=n.val(),i=e('a[data-dk-dropdown-value="'+r+'"]',p),o=i.text();p.find(".dk_label").text(o?o:"&nbsp;");E(i.parent(),p,t);s.settings.change&&s.settings.change.call(n,r,o)});m=n.attr("form")?e("#"+n.attr("form").replace(" ",", #")):n.closest("form");m.length&&m.on("reset",function(){n.dropkick("reset")})})};u.theme=function(t){var n=e(this).data("dropkick"),r=n.$dk,i="dk_theme_"+n.theme;r.removeClass(i).addClass("dk_theme_"+t);n.theme=t};u.reset=function(t){return this.each(function(){var n=e(this).data("dropkick"),r=n.$dk,i=e('a[data-dk-dropdown-value="'+n.$original.attr("value")+'"]',r);n.$original.prop("selected",!0);E(i.parent(),r);m(i,r,!t)})};u.setValue=function(t){return this.each(function(){var n=e(this).data("dropkick").$dk,r=e('.dk_options a[data-dk-dropdown-value="'+t+'"]',n);r.length?m(r,n)|E(r.parent(),n):console.warn("There is no option with this value in "+n.selector)})};u.refresh=function(t){return this.each(function(){var n=e(this).data("dropkick"),r=n.$select,i=n.$dk,s,o;n.options=r.children();o=T(l,n).find(".dk_options_inner");i.find(".dk_options_inner").replaceWith(o);if(!n.$original.parent().length){n.$original=r.find(":selected").first();n.label=n.$original.text()}s=e('a[data-dk-dropdown-value="'+r.val()+'"]',i);E(s.parent(),i);m(s,i,!t)})};u.destroy=function(){return this.each(function(){var t=e(this).data("dropkick");t.$dk.before(function(){return t.$select.removeData("dropkick")}).remove()})};u.clone=function(t,n,r){var i=[];e.each(this,function(s){var o=e(this).data("dropkick"),u=o.settings,a=o.$select.clone();u.autoWidth&&(u.width=o.$dk.find(".dk_label").width());n&&a.attr({id:n});r&&a.attr({name:r});a.removeData("dropkick");if(t==0)i[s]=a[0];else{a.dropkick(u);i[s]=a.data("dropkick").$dk[0]}})};u.disable=function(t){return this.each(function(){var n=e(this).data("dropkick"),r=n.$select,i=n.$dk;if(t==0){r.removeAttr("disabled");i.removeAttr("disabled").attr({tabindex:n.tabindex})}else{i.hasClass("dk_open")&&g(i);r.attr({disabled:"disabled"});i.attr({disabled:"disabled",tabindex:-1})}})};e.fn.dropkick=function(e){if(!s){if(u[e])return u[e].apply(this,Array.prototype.slice.call(arguments,1));if(typeof e=="object"||!e)return u.init.apply(this,arguments)}};e(function(){e(n).on(i?"mousedown":"click",".dk_options a",function(){var t=e(this),n=t.parent(),r=t.parents(".dk_container").first();if(!n.hasClass("disabled")&&!n.closest(".dk_optgroup",r).hasClass("disabled")){if(!n.hasClass("dk_option_current")){m(t,r);E(t.parent(),r)}g(r)}return!1});e(n).on("keydown.dk_nav",function(e){var t;d?t=d:v&&(t=v);t&&S(e,t)});e(n).on("click",null,function(t){var n=e(t.target),r;if(d&&n.closest(".dk_container").length===0)g(d);else{if(n.is(".dk_toggle, .dk_label")){r=n.parents(".dk_container").first();if(r.hasClass("dk_open"))g(r);else{d&&g(d);!r.attr("disabled")&&w(r,t)}return!1}n.attr("for")&&!!e("#dk_container_"+n.attr("for"))[0]&&e("#dk_container_"+n.attr("for")).trigger("focus.dropkick")}});var r="onwheel"in t?"wheel":"onmousewheel"in n?"mousewheel":"MouseScrollEvent"in t?"DOMMouseScroll MozMousePixelScroll":!1;r&&e(n).on(r,".dk_options_inner",function(e){var t=e.originalEvent.wheelDelta||-e.originalEvent.deltaY||-e.originalEvent.detail;if(i){this.scrollTop-=Math.round(t/10);return!1}return t>0&&this.scrollTop<=0||t<0&&this.scrollTop>=this.scrollHeight-this.offsetHeight?!1:!0})})})(jQuery,window,document);