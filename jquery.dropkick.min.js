(function(i,m){var c={};var p=[];var k=(m.Mustache&&m.Mustache.to_html)?m.Mustache:false;var l={left:37,up:38,right:39,down:40,enter:13};var e=['<div class="dropkick_container" id="dropkick_container_{{ id }}" tabindex={{ tabindex }}>','<a class="dropkick_toggle">','<span class="dropkick_label">{{ label }}</span>',"</a>",'<div class="dropkick_options">','<div class="dropkick_options_inner">',"</div>","</div>","</div>"].join("");var f={height:"250px",fixed:true,change:false,quickClick:false};var h;c.init=function(r){r=i.extend({},f,r);h=i("*[tabindex]").last().attr("tabindex")+1||1;i(document).bind("keydown.dropkick_nav",function(v){var t=i(".dropkick_container.open");var s=i(".dropkick_container.dropkick_focus");var u;if(t.length){u=t}else{if(s.length&&!t.length){u=s}}if(u){g(v,u)}});return this.each(function(){var B=i(this);var t=B.find(":selected").first();var C=B.find("option");var z=B.data("dropkick")||{};var w=B.attr("id")||B.attr("name");var u=0;var s=false;var A=r.quickClick?"mousedown":"click";if(z.id){return B}else{z.tabindex=h;z.id=w;z.$selected=t;z.$list=B;z.value=d(B.val())||d(t.attr("value"));z.label=t.text();z.options=C}s=a(e,z);if(r.fixed){for(var y=0,x=C.length;y<x;y++){var v=C.eq(y).text().length*6;if(v>u){u=v}}}B.hide().before(s);s=i("#dropkick_container_"+w);z.$menu=s;B.data("dropkick",z);s.data("dropkick",z);p[p.length]=B;s.bind("focus.dropkick",function(D){s.addClass("dropkick_focus")}).bind("blur.dropkick",function(D){s.removeClass("open dropkick_focus")});s.find(".dropkick_toggle").bind(A,function(D){n(s);D.preventDefault();return false}).css({width:u>0?u+"px":"auto"});s.find(".dropkick_options a").bind(A,function(E){var D=i(this);o(s);q(D,s);j(D.parent(),s.find(".dropkick_option_current"),s);if(r.change){r.change.call(D,D.attr("data-dk-menu-value"),D.text())}E.preventDefault();return false});h++})};c.reset=function(){for(var s=0,r=p.length;s<r;s++){var t=p[s].data("dropkick");var u=t.$menu.find(".dropkick_option_current");t.$menu.find(".dropkick_label").text(t.options.eq(0).text());t.$menu.find(".dropkick_options_inner").animate({scrollTop:0},0);u.removeClass("dropkick_option_current")}};function g(w,r){var s=w.keyCode;var z=r.find(".dropkick_options");var x=z.find(".dropkick_option_current");var v,t;var u=z.find("li").first();var y=z.find("li").last();switch(s){case l.enter:if(r.hasClass("open")){q(z.find(".dropkick_option_current a"),r);o(r)}else{n(r)}break;case l.up:t=x.prev("li");if(t.length){j(t,x,r)}else{j(y,x,r)}break;case l.down:if(r.hasClass("open")){v=x.next("li");if(v.length){j(v,x,r)}else{j(u,x,r)}}else{n(r)}break;default:break}}function q(t,s){var u,r;u=t.attr("data-dk-menu-value");r=t.text();$list=s.data("dropkick").$list;$list.val(u);s.find(".dropkick_label").text(r)}function j(u,s,t){var r;s.removeClass("dropkick_option_current");u.addClass("dropkick_option_current");b(t,u.prevAll("li"))}function b(t,s){var r=s.prevAll("li").outerHeight()*s.prevAll("li").length;t.find(".dropkick_options_inner").animate({scrollTop:r+"px"},0)}function o(r){r.removeClass("open")}function n(r){r.toggleClass("open");b(r,r.find(".dropkick_option_current"))}function a(x,z){if(k){return i(k.to_html(x,z))}else{var s=x,r,A=[];s=s.replace("{{ id }}",z.id);s=s.replace("{{ label }}",z.label);s=s.replace("{{ tabindex }}",z.tabindex);if(z.options&&z.options.length){for(var v=0,u=z.options.length;v<u;v++){var w=i(z.options[v]);var t='<li class="{{ current }}"><a data-dk-menu-value="{{ value }}">{{ text }}</a></li>';var y="dropkick_option_current";t=t.replace("{{ value }}",w.val()).replace("{{ current }}",(d(w.val())===z.value)?y:"");t=t.replace("{{ text }}",w.text());A[A.length]=t}}r=i(s);r.find(".dropkick_options_inner").html(A.join(""));return r}}function d(r){return(i.trim(r).length>0)?r:false}i.fn.dropkick=function(r){if(c[r]){return c[r].apply(this,Array.prototype.slice.call(arguments,1))}else{if(typeof r==="object"||!r){return c.init.apply(this,arguments)}}}})(jQuery,window);