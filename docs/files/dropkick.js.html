<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>dropkick.js</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="icon" href="../assets/favicon.ico">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
                <h1><img src="../assets/css/logo.png" title="" width="117" height="52"></h1>
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: </em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
                    <h2 class="off-left">APIs</h2>
                    <div id="api-tabview" class="tabview">
                        <ul class="tabs">
                            <li><a href="#api-classes">Classes</a></li>
                            <li><a href="#api-modules">Modules</a></li>
                        </ul>
                
                        <div id="api-tabview-filter">
                            <input type="search" id="api-filter" placeholder="Type to filter APIs">
                        </div>
                
                        <div id="api-tabview-panel">
                            <ul id="api-classes" class="apis classes">
                                <li><a href="../classes/Dropkick.html">Dropkick</a></li>
                            </ul>
                
                            <ul id="api-modules" class="apis modules">
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
                    Show:
                    <label for="api-show-inherited">
                        <input type="checkbox" id="api-show-inherited" checked>
                        Inherited
                    </label>
            
                    <label for="api-show-protected">
                        <input type="checkbox" id="api-show-protected">
                        Protected
                    </label>
            
                    <label for="api-show-private">
                        <input type="checkbox" id="api-show-private">
                        Private
                    </label>
                    <label for="api-show-deprecated">
                        <input type="checkbox" id="api-show-deprecated">
                        Deprecated
                    </label>
            
                </div>
            
            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
<h1 class="file-heading">File: dropkick.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
/*
 * DropKick 2.1.3
 *
 * Highly customizable &lt;select&gt; lists
 * https://github.com/robdel12/DropKick
 *
*/

// Enable indexOf, forEach, and EventListener methods for IE
(function(){if(Array.prototype.indexOf||(Array.prototype.indexOf=function(a,b){var c,d,e=b?b:0;if(!this)throw new TypeError;if(d=this.length,0===d||e&gt;=d)return-1;for(0&gt;e&amp;&amp;(e=d-Math.abs(e)),c=e;d&gt;c;c++)if(this[c]===a)return c;return-1}),Array.prototype.forEach||(Array.prototype.forEach=function(a){if(void 0===this||null===this)throw new TypeError;var b=Object(this),c=b.length&gt;&gt;&gt;0;if(&quot;function&quot;!=typeof a)throw new TypeError;for(var d=arguments.length&gt;=2?arguments[1]:void 0,e=0;c&gt;e;e++)e in b&amp;&amp;a.call(d,b[e],e,b)}),Event.prototype.preventDefault||(Event.prototype.preventDefault=function(){this.returnValue=!1}),Event.prototype.stopPropagation||(Event.prototype.stopPropagation=function(){this.cancelBubble=!0}),!Element.prototype.addEventListener){var a=[],b=function(b,c){var d=this,e=function(a){a.target=a.srcElement,a.currentTarget=d,c.handleEvent?c.handleEvent(a):c.call(d,a)};if(&quot;DOMContentLoaded&quot;==b){var f=function(a){&quot;complete&quot;==document.readyState&amp;&amp;e(a)};if(document.attachEvent(&quot;onreadystatechange&quot;,f),a.push({object:this,type:b,listener:c,wrapper:f}),&quot;complete&quot;==document.readyState){var g=new Event;g.srcElement=window,f(g)}}else this.attachEvent(&quot;on&quot;+b,e),a.push({object:this,type:b,listener:c,wrapper:e})},c=function(b,c){for(var d=0;d&lt;a.length;){var e=a[d];if(e.object==this&amp;&amp;e.type==b&amp;&amp;e.listener==c){&quot;DOMContentLoaded&quot;==b?this.detachEvent(&quot;onreadystatechange&quot;,e.wrapper):this.detachEvent(&quot;on&quot;+b,e.wrapper);break}++d}};Element.prototype.addEventListener=b,Element.prototype.removeEventListener=c,HTMLDocument&amp;&amp;(HTMLDocument.prototype.addEventListener=b,HTMLDocument.prototype.removeEventListener=c),Window&amp;&amp;(Window.prototype.addEventListener=b,Window.prototype.removeEventListener=c)} function CustomEvent(e,t){t=t||{bubbles:false,cancelable:false,detail:undefined};var n=document.createEvent(&quot;CustomEvent&quot;);n.initCustomEvent(e,t.bubbles,t.cancelable,t.detail);return n}CustomEvent.prototype=window.Event.prototype;window.CustomEvent=CustomEvent;})();

(function( window, document, undefined ) {


var

  // Browser testing stuff
  isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test( navigator.userAgent ),
  isIframe = (window.parent != window.self &amp;&amp; location.host === parent.location.host),
  isIE = navigator.appVersion.indexOf(&quot;MSIE&quot;)!=-1,

  /**
  * Dropkick constructor
  *
  * @class Dropkick
  * @constructor
  */
  Dropkick = function( sel, opts ) {
    var i, dk;

    // Safety if &#x60;Dropkick&#x60; is called without &#x60;new&#x60;
    if ( this === window ) {
      return new Dropkick( sel, opts );
    }

    if ( typeof sel === &quot;string&quot; &amp;&amp; sel[0] === &quot;#&quot; ) {
      sel = document.getElementById( sel.substr( 1 ) );
    }

    // Check if select has already been DK&#x27;d and return the DK Object
    for ( i = 0; i &lt; Dropkick.uid; i++) {
      dk = Dropkick.cache[ i ];

      if ( dk instanceof Dropkick &amp;&amp; dk.data.select === sel ) {
        _.extend( dk.data.settings, opts );
        return dk;
      }
    }

    if ( sel.nodeName === &quot;SELECT&quot; ) {
      return this.init( sel, opts );
    }
  },

  noop = function() {},
  _docListener,

  // DK default options
  defaults = {

    // Called once after the DK element is inserted into the DOM
    initialize: noop,

    // Called every time the select changes value
    change: noop,

    // Called every time the DK element is opened
    open: noop,

    // Called every time the DK element is closed
    close: noop,

    // Search method; &quot;strict&quot;, &quot;partial&quot;, or &quot;fuzzy&quot;
    search: &quot;strict&quot;
  },

  // Common Utilities
  _ = {

    hasClass: function( elem, classname ) {
      var reg = new RegExp( &quot;(^|\\s+)&quot; + classname + &quot;(\\s+|$)&quot; );
      return elem &amp;&amp; reg.test( elem.className );
    },

    addClass: function( elem, classname ) {
      if( elem &amp;&amp; !_.hasClass( elem, classname ) ) {
        elem.className += &quot; &quot; + classname;
      }
    },

    removeClass: function( elem, classname ) {
      var reg = new RegExp( &quot;(^|\\s+)&quot; + classname + &quot;(\\s+|$)&quot; );
      elem &amp;&amp; ( elem.className = elem.className.replace( reg, &quot; &quot; ) );
    },

    toggleClass: function( elem, classname ) {
      var fn = _.hasClass( elem, classname ) ? &quot;remove&quot; : &quot;add&quot;;
      _[ fn + &quot;Class&quot; ]( elem, classname );
    },

    // Shallow object extend
    extend: function( obj ) {
      Array.prototype.slice.call( arguments, 1 ).forEach( function( source ) {
        if ( source ) for ( var prop in source ) obj[ prop ] = source[ prop ];
      });

      return obj;
    },

    // Returns the top and left offset of an element
    offset: function( elem ) {
      var box = elem.getBoundingClientRect() || { top: 0, left: 0 },
        docElem = document.documentElement,
        offsetTop = isIE ? docElem.scrollTop : window.pageYOffset,
        offsetLeft = isIE ? docElem.scrollLeft : window.pageXOffset;

        return {
          top: box.top + offsetTop - docElem.clientTop,
          left: box.left + offsetLeft - docElem.clientLeft
        };
    },

    // Returns the top and left position of an element relative to an ancestor
    position: function( elem, relative ) {
      var pos = { top: 0, left: 0 };

      while ( elem !== relative ) {
        pos.top += elem.offsetTop;
        pos.left += elem.offsetLeft;
        elem = elem.parentNode;
      }

      return pos;
    },

    // Returns the closest ancestor element of the child or false if not found
    closest: function( child, ancestor ) {
      while ( child ) {
        if ( child === ancestor ) return child;
        child = child.parentNode;
      }
      return false;
    },

    // Creates a DOM node with the specified attributes
    create: function( name, attrs ) {
      var a, node = document.createElement( name );

      if ( !attrs ) attrs = {};

      for ( a in attrs ) {
        if ( attrs.hasOwnProperty( a ) ) {
          if ( a == &quot;innerHTML&quot; ) {
            node.innerHTML = attrs[ a ];
          } else {
            node.setAttribute( a, attrs[ a ] );
          }
        }
      }

      return node;
    },

    deferred: function( fn ) {
      return function() {
        var args = arguments,
          ctx = this;

        window.setTimeout(function() {
          fn.apply(ctx, args);
        }, 1);
      };
    }

  };


// Cache of DK Objects
Dropkick.cache = {}
Dropkick.uid = 0;


// Extends the DK objects&#x27;s Prototype
Dropkick.prototype = {

  // Emulate some of HTMLSelectElement&#x27;s methods

  /**
   * Adds an element to the select
   *
   * @method add
   * @param {string} elem   HTMLOptionElement
   * @param {Node/Integer} before HTMLOptionElement/Index of Element
   */
  add: function( elem, before ) {
    var text, option, i;

    if ( typeof elem === &quot;string&quot; ) {
      text = elem;
      elem = document.createElement(&quot;option&quot;);
      elem.text = text;
    }

    if ( elem.nodeName === &quot;OPTION&quot; ) {
      option = _.create( &quot;li&quot;, {
        &quot;class&quot;: &quot;dk-option&quot;,
        &quot;data-value&quot;: elem.value,
        &quot;innerHTML&quot;: elem.text,
        &quot;role&quot;: &quot;option&quot;,
        &quot;aria-selected&quot;: &quot;false&quot;,
        &quot;id&quot;: &quot;dk&quot; + this.data.cacheID + &quot;-&quot; + ( elem.id || elem.value.replace( &quot; &quot;, &quot;-&quot; ) )
      });

      _.addClass( option, elem.className );
      this.length += 1;

      if ( elem.disabled ) {
        _.addClass( option, &quot;dk-option-disabled&quot; );
        option.setAttribute( &quot;aria-disabled&quot;, &quot;true&quot; );
      }

      this.data.select.add( elem, before );

      if ( typeof before === &quot;number&quot; ) {
        before = this.item( before );
      }

      if ( this.options.indexOf( before ) &gt; -1 ) {
        before.parentNode.insertBefore( option, before );
      } else {
        this.data.elem.lastChild.appendChild( option );
      }

      option.addEventListener( &quot;mouseover&quot;, this );

      i = this.options.indexOf( before );
      this.options.splice( i, 0, option );

      if ( elem.selected ) {
        this.select( i );
      }
    }
  },

  /**
   * Selects an option in the lists at the desired index
   * (negative numbers select from the end)
   *
   * @method item
   * @param  {Integer} index Index of element (positive or negative)
   * @return {Node}          The DK option from the list, or null if not found
   */
  item: function( index ) {
    index = index &lt; 0 ? this.options.length + index : index;
    return this.options[ index ] || null;
  },

  /**
   * Removes an element at the given index
   *
   * @method  remove
   * @param  {Integer} index Index of element (positive or negative)
   */
  remove: function( index ) {
    var dkOption = this.item( index );
    dkOption.parentNode.removeChild( dkOption );
    this.options.splice( index, 1 );
    this.data.select.remove( index );
    this.select( this.data.select.selectedIndex );
    this.length -= 1;
  },

  /**
   * Initializes the DK Object
   *
   * @method init
   * @param  {Node}   sel  [description]
   * @param  {Object} opts Options to override defaults
   * @return {Object}      The DK Object
   */
  init: function( sel, opts ) {
    var i,
      dk =  Dropkick.build( sel, &quot;dk&quot; + Dropkick.uid );

    // Set some data on the DK Object
    this.data = {};
    this.data.select = sel;
    this.data.elem = dk.elem;
    this.data.settings = _.extend({}, defaults, opts );

    // Emulate some of HTMLSelectElement&#x27;s properties
    this.disabled = sel.disabled;
    this.form = sel.form;
    this.length = sel.length;
    this.multiple = sel.multiple;
    this.options = dk.options.slice( 0 );
    this.selectedIndex = sel.selectedIndex;
    this.selectedOptions = dk.selected.slice( 0 );
    this.value = sel.value;

    // Add the DK Object to the cache
    this.data.cacheID = Dropkick.uid;
    Dropkick.cache[ this.data.cacheID ] = this;

    // Call the optional initialize function
    this.data.settings.initialize.call( this );

    // Increment the index
    Dropkick.uid += 1;

    // Add the change listener to the select
    if ( !this._changeListener ) {
      sel.addEventListener( &quot;change&quot;, this );
      this._changeListener = true;
    }

    // Don&#x27;t continue if we&#x27;re not rendering on mobile
    if ( !( isMobile &amp;&amp; !this.data.settings.mobile ) ) {

      // Insert the DK element before the original select
      sel.parentNode.insertBefore( this.data.elem, sel );
      sel.setAttribute( &quot;data-dkCacheId&quot;, this.data.cacheID );

      // Bind events
      this.data.elem.addEventListener( &quot;click&quot;, this );
      this.data.elem.addEventListener( &quot;keydown&quot;, this );
      this.data.elem.addEventListener( &quot;keypress&quot;, this );

      if ( this.form ) {
        this.form.addEventListener( &quot;reset&quot;, this );
      }

      if ( !this.multiple ) {
        for ( i = 0; i &lt; this.options.length; i++ ) {
          this.options[ i ].addEventListener( &quot;mouseover&quot;, this );
        }
      }

      if ( !_docListener ) {
        document.addEventListener( &quot;click&quot;, Dropkick.onDocClick );

        if ( isIframe ){
          parent.document.addEventListener( &quot;click&quot;, Dropkick.onDocClick );
        }

        _docListener = true;
      }
    }

    return this;
  },

  /**
   * Closes the DK dropdown
   *
   * @method close
   */
  close: function() {
    var i,
      dk = this.data.elem;

    if ( !this.isOpen || this.multiple ) {
      return false;
    }

    for ( i = 0; i &lt; this.options.length; i++ ) {
      _.removeClass( this.options[ i ], &quot;dk-option-highlight&quot; );
    }

    dk.lastChild.setAttribute( &quot;aria-expanded&quot;, &quot;false&quot; );
    _.removeClass( dk.lastChild, &quot;dk-select-options-highlight&quot; );
    _.removeClass( dk, &quot;dk-select-open-(up|down)&quot; );
    this.isOpen = false;

    this.data.settings.close.call( this );
  },

  /**
   * Opens the DK dropdown
   *
   * @method open
   */
  open: _.deferred(function() {
    var dropHeight, above, below, direction, dkTop, dkBottom,
      dk = this.data.elem,
      dkOptsList = dk.lastChild;

    if ( isIE ) {
      dkTop = _.offset( dk ).top - document.documentElement.scrollTop;
    } else {
      dkTop = _.offset( dk ).top - window.scrollY;
    }

    dkBottom = window.innerHeight - ( dkTop + dk.offsetHeight );

    if ( this.isOpen || this.multiple ) return false;

    dkOptsList.style.display = &quot;block&quot;;
    dropHeight = dkOptsList.offsetHeight;
    dkOptsList.style.display = &quot;&quot;;

    above = dkTop &gt; dropHeight;
    below = dkBottom &gt; dropHeight;
    direction = above &amp;&amp; !below ? &quot;-up&quot; : &quot;-down&quot;;

    this.isOpen = true;
    _.addClass( dk, &quot;dk-select-open&quot; + direction );
    dkOptsList.setAttribute( &quot;aria-expanded&quot;, &quot;true&quot; );
    this._scrollTo( this.options.length - 1 );
    this._scrollTo( this.selectedIndex );

    this.data.settings.open.call( this );
  }),

  /**
   * Disables or enables an option or the entire Dropkick
   *
   * @method disable
   * @param  {Integer} elem     The element or index to disable
   * @param  {Boolean}      disabled Value of disabled
   */
  disable: function( elem, disabled ) {
    var disabledClass = &quot;dk-option-disabled&quot;;

    if ( arguments.length === 0 || typeof elem === &quot;boolean&quot; ) {
      disabled = elem === undefined ? true : false;
      elem = this.data.elem;
      disabledClass = &quot;dk-select-disabled&quot;;
      this.disabled = disabled;
    }

    if ( disabled === undefined ) {
      disabled = true;
    }

    if ( typeof elem === &quot;number&quot; ) {
      elem = this.item( elem );
    }

    _[ disabled ? &quot;addClass&quot; : &quot;removeClass&quot; ]( elem, disabledClass );
  },

  /**
   * Selects an option from the list
   *
   * @method select
   * @param  {String} elem     The element, index, or value to select
   * @param  {Boolean}             disabled Selects disabled options
   * @return {Node}                         The selected element
   */
  select: function( elem, disabled ) {
    var i, index, option, combobox,
      select = this.data.select;

    if ( typeof elem === &quot;number&quot; ) {
      elem = this.item( elem );
    }

    if ( typeof elem === &quot;string&quot; ) {
      for ( i = 0; i &lt; this.length; i++ ) {
        if ( this.options[ i ].getAttribute( &quot;data-value&quot; ) == elem ) {
          elem = this.options[ i ];
        }
      }
    }

    // No element or enabled option
    if ( !elem || typeof elem === &quot;string&quot; ||
         ( !disabled &amp;&amp; _.hasClass( elem, &quot;dk-option-disabled&quot; ) ) ) {
      return false;
    }

    if ( _.hasClass( elem, &quot;dk-option&quot; ) ) {
      index = this.options.indexOf( elem );
      option = select.options[ index ];

      if ( this.multiple ) {
        _.toggleClass( elem, &quot;dk-option-selected&quot; );
        option.selected = !option.selected;

        if ( _.hasClass( elem, &quot;dk-option-selected&quot; ) ) {
          elem.setAttribute( &quot;aria-selected&quot;, &quot;true&quot; );
          this.selectedOptions.push( elem );
        } else {
          elem.setAttribute( &quot;aria-selected&quot;, &quot;false&quot; );
          index = this.selectedOptions.indexOf( elem );
          this.selectedOptions.splice( index, 1 );
        }
      } else {
        combobox = this.data.elem.firstChild;

        if ( this.selectedOptions.length ) {
          _.removeClass( this.selectedOptions[0], &quot;dk-option-selected&quot; );
          this.selectedOptions[0].setAttribute( &quot;aria-selected&quot;, &quot;false&quot; );
        }

        _.addClass( elem, &quot;dk-option-selected&quot; );
        elem.setAttribute( &quot;aria-selected&quot;, &quot;true&quot; );

        combobox.setAttribute( &quot;aria-activedescendant&quot;, elem.id );
        combobox.className = &quot;dk-selected &quot; + option.className;
        combobox.innerHTML = option.text;

        this.selectedOptions[0] = elem;
        option.selected = true;
      }

      this.selectedIndex = select.selectedIndex;
      this.value = select.value;

      if ( !disabled ) {
        this.data.select.dispatchEvent( new CustomEvent( &quot;change&quot; ) );
      }

      return elem;
    }
  },

  /**
   * Selects a single option from the list
   *
   * @method selectOne
   * @param  {Integer} elem     The element or index to select
   * @param  {Boolean}      disabled Selects disabled options
   * @return {Node}                  The selected element
   */
  selectOne: function( elem, disabled ) {
    this.reset( true );
    this._scrollTo( elem );
    return this.select( elem, disabled );
  },

  /**
   * Finds all options who&#x27;s text matches a pattern (strict, partial, or fuzzy)
   *
   * @method search
   * @param  {String} string  The string to search for
   * @param  {Integer} mode   How to search; &quot;strict&quot;, &quot;partial&quot;, or &quot;fuzzy&quot;
   * @return {Boolean}  An Array of matched elements
   */
  search: function( pattern, mode ) {
    var i, tokens, str, tIndex, sIndex, cScore, tScore, reg,
      options = this.data.select.options,
      matches = [];

    if ( !pattern ) return this.options;

    // Fix Mode
    mode = mode ? mode.toLowerCase() : &quot;strict&quot;;
    mode = mode == &quot;fuzzy&quot; ? 2 : mode == &quot;partial&quot; ? 1 : 0;

    reg = new RegExp( ( mode ? &quot;&quot; : &quot;^&quot; ) + pattern, &quot;i&quot; );

    for ( i = 0; i &lt; options.length; i++ ) {
      str = options[ i ].text.toLowerCase();

      // Fuzzy
      if ( mode == 2 ) {
        tokens = pattern.toLowerCase().split(&quot;&quot;);
        tIndex = sIndex = cScore = tScore = 0;

        while ( sIndex &lt; str.length ) {
          if ( str[ sIndex ] === tokens[ tIndex ] ) {
            cScore += 1 + cScore;
            tIndex++;
          } else {
            cScore = 0;
          }

          tScore += cScore;
          sIndex++;
        }

        if ( tIndex == tokens.length ) {
          matches.push({ e: this.options[ i ], s: tScore, i: i });
        }

      // Partial or Strict (Default)
      } else {
        reg.test( str ) &amp;&amp; matches.push( this.options[ i ] );
      }
    }

    // Sort fuzzy results
    if ( mode == 2 ) {
      matches = matches.sort( function ( a, b ) {
        return ( b.s - a.s ) || a.i - b.i;
      }).reduce( function ( p, o ) {
        p[ p.length ] = o.e;
        return p;
      }, [] );
    }

    return matches;
  },

  /**
   * Brings focus to the proper DK element
   *
   * @method focus
   */
  focus: function() {
    if ( !this.disabled ) {
      ( this.multiple ? this.data.elem : this.data.elem.children[0] ).focus();
    }
  },

  /**
   * Resets the DK and select element
   *
   * @method reset
   * @param  {Boolean} clear Defaults to first option if True
   */
  reset: function( clear ) {
    var i,
      select = this.data.select;

    this.selectedOptions.length = 0;

    for ( i = 0; i &lt; select.options.length; i++ ) {
      select.options[ i ].selected = false;
      _.removeClass( this.options[ i ], &quot;dk-option-selected&quot; );
      this.options[ i ].setAttribute( &quot;aria-selected&quot;, &quot;false&quot; );
      if ( !clear &amp;&amp; select.options[ i ].defaultSelected ) {
        this.select( i, true );
      }
    }

    if ( !this.selectedOptions.length &amp;&amp; !this.multiple ) {
      this.select( 0, true );
    }
  },

  /**
   * Rebuilds the DK Object
   * (use if HTMLSelectElement has changed)
   *
   * @method refresh
   */
  refresh: function() {
    this.dispose().init( this.data.select, this.data.settings );
  },

  /**
   * Removes the DK Object from the cache and the element from the DOM
   *
   * @method dispose
   */
  dispose: function() {
    delete Dropkick.cache[ this.data.cacheID ];
    this.data.elem.parentNode.removeChild( this.data.elem );
    this.data.select.removeAttribute( &quot;data-dkCacheId&quot; );
    return this;
  },

  // Private Methods

  /**
   * @method handleEvent
   * @private
   */
  handleEvent: function( event ) {
    if ( this.disabled ) return;

    switch ( event.type ) {
    case &quot;click&quot;:
      this._delegate( event );
      break;
    case &quot;keydown&quot;:
      this._keyHandler( event );
      break;
    case &quot;keypress&quot;:
      this._searchOptions( event );
      break;
    case &quot;mouseover&quot;:
      this._highlight( event );
      break;
    case &quot;reset&quot;:
      this.reset();
      break;
    case &quot;change&quot;:
      this.data.settings.change.call( this );
      break;
    }
  },


  /**
   * @method delegate
   * @private
   */
  _delegate: function( event ) {
    var selection, index, firstIndex, lastIndex,
      target = event.target;

    if ( _.hasClass( target, &quot;dk-option-disabled&quot; ) ) {
      return false;
    }

    if ( !this.multiple ) {
      this[ this.isOpen ? &quot;close&quot; : &quot;open&quot; ]();
      if ( _.hasClass( target, &quot;dk-option&quot; ) ) this.select( target );
    } else {
      if ( _.hasClass( target, &quot;dk-option&quot; ) ) {
        selection = window.getSelection();
        if ( selection.type == &quot;Range&quot; ) selection.collapseToStart();

        if ( event.shiftKey ) {
          firstIndex = this.options.indexOf( this.selectedOptions[0] );
          lastIndex = this.options.indexOf( this.selectedOptions[ this.selectedOptions.length - 1 ] );
          index =  this.options.indexOf( target );

          if ( index &gt; firstIndex &amp;&amp; index &lt; lastIndex ) index = firstIndex;
          if ( index &gt; lastIndex &amp;&amp; lastIndex &gt; firstIndex ) lastIndex = firstIndex;

          this.reset( true );

          if ( lastIndex &gt; index ) {
            while ( index &lt; lastIndex + 1 ) this.select( index++ );
          } else {
            while ( index &gt; lastIndex - 1 ) this.select( index-- );
          }
        } else if ( event.ctrlKey || event.metaKey ) {
          this.select( target );
        } else {
          this.reset( true );
          this.select( target );
        }
      }
    }
  },

  /**
   * @method highlight
   * @private
   */
  _highlight: function( event ) {
    var i, option = event.target;

    if ( !this.multiple ) {
      for ( i = 0; i &lt; this.options.length; i++ ) {
        _.removeClass( this.options[ i ], &quot;dk-option-highlight&quot; );
      }

      _.addClass( this.data.elem.lastChild, &quot;dk-select-options-highlight&quot; );
      _.addClass( option, &quot;dk-option-highlight&quot; );
    }
  },

  /**
   * @method keyHandler
   * @private
   */
  _keyHandler: function( event ) {
    var lastSelected, j,
      selected = this.selectedOptions,
      options = this.options,
      i = 1,
      keys = {
        tab: 9,
        enter: 13,
        esc: 27,
        space: 32,
        up: 38,
        down: 40
      };

    switch ( event.keyCode ) {
    case keys.up:
      i = -1;
      // deliberate fallthrough
    case keys.down:
      event.preventDefault();
      lastSelected = selected[ selected.length - 1 ];

      if ( _.hasClass( this.data.elem.lastChild, &quot;dk-select-options-highlight&quot; ) ) {
        _.removeClass( this.data.elem.lastChild, &quot;dk-select-options-highlight&quot; );
        for ( j = 0; j &lt; options.length; j++ ) {
          if ( _.hasClass( options[ j ], &quot;dk-option-highlight&quot; ) ) {
            _.removeClass( options[ j ], &quot;dk-option-highlight&quot; );
            lastSelected = options[ j ];
          }
        }
      }

      i = options.indexOf( lastSelected ) + i;

      if ( i &gt; options.length - 1 ) {
        i = options.length - 1;
      } else if ( i &lt; 0 ) {
        i = 0;
      }

      if ( !this.data.select.options[ i ].disabled ) {
        this.reset( true );
        this.select( i );
        this._scrollTo( i );
      }
      break;
    case keys.space:
      if ( !this.isOpen ) {
        event.preventDefault();
        this.open();
        break;
      }
      // deliberate fallthrough
    case keys.tab:
    case keys.enter:
      for ( i = 0; i &lt; options.length; i++ ) {
        if ( _.hasClass( options[ i ], &quot;dk-option-highlight&quot; ) ) {
          this.select( i );
        }
      }
      // deliberate fallthrough
    case keys.esc:
      if ( this.isOpen ) {
        event.preventDefault();
        this.close();
      }
      break;
    }
  },

  /**
   * @method searchOptions
   * @private
   */
  _searchOptions: function( event ) {
    var results,
      self = this,
      keyChar = String.fromCharCode( event.keyCode || event.which ),

      waitToReset = function() {
        if ( self.data.searchTimeout ) {
          clearTimeout( self.data.searchTimeout );
        }

        self.data.searchTimeout = setTimeout(function() {
          self.data.searchString = &quot;&quot;;
        }, 1000 );
      };

    if ( this.data.searchString === undefined ) {
      this.data.searchString = &quot;&quot;;
    }

    waitToReset();

    this.data.searchString += keyChar;
    results = this.search( this.data.searchString, this.data.settings.search );

    if ( results.length ) {
      if ( !_.hasClass( results[0], &quot;dk-option-disabled&quot; ) ) {
        this.selectOne( results[0] );
      }
    }
  },

  /**
   * @method scrollTo
   * @private
   */
  _scrollTo: function( option ) {
    var optPos, optTop, optBottom,
      dkOpts = this.data.elem.lastChild;

    if ( option === -1 || ( typeof option !== &quot;number&quot; &amp;&amp; !option ) ||
        ( !this.isOpen &amp;&amp; !this.multiple ) ) {
      return false;
    }

    if ( typeof option === &quot;number&quot; ) {
      option = this.item( option );
    }

    optPos = _.position( option, dkOpts ).top;
    optTop = optPos - dkOpts.scrollTop;
    optBottom = optTop + option.offsetHeight;

    if ( optBottom &gt; dkOpts.offsetHeight ) {
      optPos += option.offsetHeight;
      dkOpts.scrollTop = optPos - dkOpts.offsetHeight;
    } else if ( optTop &lt; 0 ) {
      dkOpts.scrollTop = optPos;
    }
  }
};

// Static Methods

/**
 * Builds the Dropkick element from a select element
 *
 * @method  build
 * @param  {Node} sel The HTMLSelectElement
 * @return {Object}   An object containing the new DK element and it&#x27;s options
 */
Dropkick.build = function( sel, idpre ) {
  var selOpt, optList, i,
    options = [],

    ret = {
      elem: null,
      options: [],
      selected: []
    },

    addOption = function ( node ) {
      var option, optgroup, optgroupList, i,
        children = [];

      switch ( node.nodeName ) {
      case &quot;OPTION&quot;:
        option = _.create( &quot;li&quot;, {
          &quot;class&quot;: &quot;dk-option &quot;,
          &quot;data-value&quot;: node.value,
          &quot;innerHTML&quot;: node.text,
          &quot;role&quot;: &quot;option&quot;,
          &quot;aria-selected&quot;: &quot;false&quot;,
          &quot;id&quot;: idpre + &quot;-&quot; + ( node.id || node.value.replace( &quot; &quot;, &quot;-&quot; ) )
        });

        _.addClass( option, node.className );

        if ( node.disabled ) {
          _.addClass( option, &quot;dk-option-disabled&quot; );
          option.setAttribute( &quot;aria-disabled&quot;, &quot;true&quot; );
        }

        if ( node.selected ) {
          _.addClass( option, &quot;dk-option-selected&quot; );
          option.setAttribute( &quot;aria-selected&quot;, &quot;true&quot; );
          ret.selected.push( option );
        }

        ret.options.push( this.appendChild( option ) );
        break;
      case &quot;OPTGROUP&quot;:
        optgroup = _.create( &quot;li&quot;, { &quot;class&quot;: &quot;dk-optgroup&quot; });

        if ( node.label ) {
          optgroup.appendChild( _.create( &quot;div&quot;, {
            &quot;class&quot;: &quot;dk-optgroup-label&quot;,
            &quot;innerHTML&quot;: node.label
          }));
        }

        optgroupList = _.create( &quot;ul&quot;, {
          &quot;class&quot;: &quot;dk-optgroup-options&quot;
        });

        for ( i = node.children.length; i--; children.unshift( node.children[ i ] ) );
        children.forEach( addOption, optgroupList );

        this.appendChild( optgroup ).appendChild( optgroupList );
        break;
      }
    };

  ret.elem = _.create( &quot;div&quot;, {
    &quot;class&quot;: &quot;dk-select&quot; + ( sel.multiple ? &quot;-multi&quot; : &quot;&quot; )
  });

  optList = _.create( &quot;ul&quot;, {
    &quot;class&quot;: &quot;dk-select-options&quot;,
    &quot;id&quot;: idpre + &quot;-listbox&quot;,
    &quot;role&quot;: &quot;listbox&quot;
  });

  sel.disabled &amp;&amp; _.addClass( ret.elem, &quot;dk-select-disabled&quot; );
  ret.elem.id = idpre + ( sel.id ? &quot;-&quot; + sel.id : &quot;&quot; );
  _.addClass( ret.elem, sel.className );

  if ( !sel.multiple ) {
    selOpt = sel.options[ sel.selectedIndex ];
    ret.elem.appendChild( _.create( &quot;div&quot;, {
      &quot;class&quot;: &quot;dk-selected &quot; + selOpt.className,
      &quot;tabindex&quot;: sel.tabindex || 0,
      &quot;innerHTML&quot;: selOpt ? selOpt.text : &#x27;&amp;nbsp;&#x27;,
      &quot;id&quot;: idpre + &quot;-combobox&quot;,
      &quot;aria-live&quot;: &quot;assertive&quot;,
      &quot;aria-owns&quot;: optList.id,
      &quot;role&quot;: &quot;combobox&quot;
    }));
    optList.setAttribute( &quot;aria-expanded&quot;, &quot;false&quot; );
  } else {
    ret.elem.setAttribute( &quot;tabindex&quot;, sel.getAttribute( &quot;tabindex&quot; ) || &quot;0&quot; );
    optList.setAttribute( &quot;aria-multiselectable&quot;, &quot;true&quot; );
  }

  for ( i = sel.children.length; i--; options.unshift( sel.children[ i ] ) );
  options.forEach( addOption, ret.elem.appendChild( optList ) );

  return ret;
};

/**
 * Focus DK Element when corresponding label is clicked; close all other DK&#x27;s
 *
 * @method  onDocClick
 * @param {Object} event  Event from document click
 */
Dropkick.onDocClick = function( event ) {
  var t, tId, i;

  if (event.target.nodeType !== 1) {
    isClicked = false;

    return false;
  }

  if ( ( tId = event.target.getAttribute( &quot;data-dkcacheid&quot; ) ) !== null ) {
    Dropkick.cache[ tId ].focus();
  }

  for ( i in Dropkick.cache ) {
    if ( !_.closest( event.target, Dropkick.cache[ i ].data.elem ) &amp;&amp; i !== tId ) {
      Dropkick.cache[ i ].disabled || Dropkick.cache[ i ].close();
    }
  }
};


// Expose Dropkick Globally
window.Dropkick = Dropkick;

// Add jQuery method
if ( window.jQuery !== undefined ) {
  window.jQuery.fn.dropkick = function () {
    var args = Array.prototype.slice.call( arguments );
    return window.jQuery( this ).each(function() {
      if ( !args[0] || typeof args[0] === &#x27;object&#x27; ) {
        new Dropkick( this, args[0] || {} );
      } else if ( typeof args[0] === &#x27;string&#x27; ) {
        Dropkick.prototype[ args[0] ].apply( new Dropkick( this ), args.slice( 1 ) );
      }
    });
  };
}

})( window, document );

    </pre>
</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
